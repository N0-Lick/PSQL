select name from Passenger;
select name from company;
select * from Trip where town_from='Moscow';
select name from Passenger where name like '%man';
select * from trip where plane='TU-134';
select distinct name from company where id in (select company from trip where plane='Boeing');
select distinct plane from trip where town_to='Moscow';
select town_to, age(time_in, time_out) as flight_time from trip where town_from='Paris';
select name from company where id in (select company from trip where town_from='Vladivostok');
select * from trip where time_out between '1900-01-01 10:00:00' and '1900-01-01 14:00:00';
select name from Passenger where character_length(name)=(select max(character_length(name)) from passenger);
select trip, count(passenger) as count from pass_in_trip group by trip;
select name from passenger group by name having count(name) > 1;
select town_to from trip join pass_in_trip on trip.id=pass_in_trip.trip join passenger on pass_in_trip.passenger=passenger.id where name='Bruce Willis';
select time_in from trip join pass_in_trip on trip.id=pass_in_trip.trip join passenger on pass_in_trip.passenger=passenger.id where name='Steve Martin' and town_to='London';
select passenger.name, count(*) as count from passenger join pass_in_trip on passenger.id=pass_in_trip.passenger group by passenger.name having count(trip) > 0 order by count(trip) desc, name;
select count(company) from trip where town_from='Rostov' and town_to='Moscow';
SELECT name FROM Passenger JOIN Pass_in_trip ON Passenger.id=Pass_in_trip.passenger JOIN Trip ON Pass_in_trip.trip=Trip.id WHERE town_to='Moscow' AND plane='TU-134';
DELETE FROM Company WHERE Company.id IN (SELECT company FROM Trip GROUP BY company HAVING COUNT(id) = (SELECT MIN(count) FROM (SELECT COUNT(id) AS count FROM Trip GROUP BY company) AS min_count));
DELETE FROM Trip WHERE trip.id = (select trip.id from trip join (select town_to, time_in from trip where town_to = 'Moscow') as var on trip.town_from = var.town_to and trip.time_out > var.time_in);
